# Preference data
A <- c(18, 2, 20)
B <- c(22, 28, 10)
C <- c(20, 40, 40)

# Sample covariance between B and C
cov(B, C)

# Covariance matrix
pref <- data.frame(A, B, C)
cov(pref)

# Sample correlation between B and C
cor(B, C)

# Correlation matrix
cor(pref)

# Given dataset
data <- c(18,18,18,20,20,20,20,20,20,20,21,21,21,21,
          25,25,25,25,25,28,28,30,30,30)

# Equal-frequency binning (3 bins)
bins <- cut(rank(data), breaks=3, labels=FALSE)

# Bin means smoothing
bin_means <- tapply(data, bins, mean)
smoothed_means <- bin_means[bins]

# Bin boundary smoothing
bin_boundary <- function(x){
  sapply(x, function(v){
    if(abs(v - min(x)) < abs(v - max(x))) min(x) else max(x)
  })
}
smoothed_boundary <- unlist(tapply(data, bins, bin_boundary))

# Histogram
hist(data, main="Histogram of Data", col="lightblue")
